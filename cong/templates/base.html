{% load static %}
{% load admin_urls %}
<!DOCTYPE html>
<html>
    <head>
        <title>NEC - Secretary</title>
        <link href="{% static 'css/jquery.dataTables.css' %}" rel="stylesheet">
        <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
        <link href="{% static 'css/datepicker.css' %}" rel="stylesheet">
        <link href="{% static 'css/typeahead.js-bootstrap.css' %}" rel="stylesheet">
        <style type="text/css">
            body {
                padding-top: 120px;
                padding-bottom: 40px;
            }
            .sidebar-nav {
                padding: 9px 0;
            }
            
            @media (max-width: 980px) {
            /* Enable use of floated navbar text */
            .navbar-text.pull-right {
                float: none;
                padding-left: 50px;
                padding-right: 5px;
            }
            }
            body .modal {
                width: 70%; /* desired relative width */
                left: 15%; /* (100%-width)/2 */
                /* place center */
                margin-left:auto;
                margin-right:auto; 
            }
        </style>
        <link href="{% static 'css/bootstrap-responsive.min.css' %}" rel="stylesheet">
        <script src="{% static 'js/jquery.min.js' %}"></script>
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
        <script src="{% static 'js/bootstrap-datepicker.js' %}"></script>
        <script src="{% static 'js/typeahead.min.js' %}"></script>
        <script src="{% static 'js/jquery.dataTables.min.js' %}"></script>
        <script src="{% static 'js/eldarion-ajax.min.js' %}"></script>        
        <script >
        function tally (selector) {
            $(selector).each(function () {
                var total = 0,
                column = $(this).siblings(selector).andSelf().index(this);
                $(this).parents().prevUntil(':has(' + selector + ')').each(function () {
                    total += parseFloat($('td.sum:eq(' + column + ')', this).html()) || 0;
                })
                $(this).html(total);
            });
        }
        $(function() {
            var pubNames = [];
            var pubMapped = {};
            var publishers = [{% for p in everyone %}{"name":"{{ p.get_name }}","value":"{{ p.pk }}"}{% if not forloop.last %},{% endif %}{% endfor %}];
            /*$.each(publishers, function(i, item) {
                pubMapped[item.name] = item.id;
                pubNames.push(item.name);
            });*/
            $("#publookahead").typeahead({
                name: 'publisher',
                local: publishers
            });
            $("#addreport").click(function(){
                var pid = $('#hiddenid').val();
                if (pid) {
                    var url = "{% url 'admin:cong_publisher_change' 999 %}".replace(999, pid);
                    window.location = url;
                }
                return false;
            });
            $("#showreport").click(function(){
                var pid = $('#hiddenid').val();
                if (pid) {
                    var url = "{% url 'card' 999 %}".replace(999, pid);
                    this.href = url;
                    return true;
                }
                return false;
            });
            $("#myModal").on("hidden", function(){
                $(this).removeData('modal');
            });
           
        });
        </script>
    </head>
    <body>
	{% block navbar %}
	<div class="navbar navbar-default navbar-fixed-top">
	    <div class="navbar-header">
	        <h1 class="brand" href="#">NEC - Secretary</h1>
        </div>
        <div class="collapse navbar-collapse navbar-ext1-collapse"></div>
	        <ul class="nav navbar-nav">
	            <li class="active"><a href="{% url 'home' %}">Home</a></li>
                <li class="dropdown">
                    <a data-target="#" href="{% url 'report_month' %}" class="dropdown-toggle" data-toggle="dropdown">
                    Reports <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                        <li><a href="{% url 'report_month' %}" class="ajax">Latest report</a></li>
                        <li>    
                            <div class="input-append date" id="dp3" data-date="12-02-2012" data-date-format="dd-mm-yyyy">
                                <input class="span2" size="16" type="text" value="12-02-2012">
                                <span class="add-on"><i class="icon-th"></i></span>
                            </div>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a data-target="#" href="#" class="dropdown-toggle" data-toggle="dropdown">
                    By Group<span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                        <!-- todo make this automatic? -->
                        <li><a href="{% url 'report_group' 1 %}">1- Msawmai</a></li>
                        <li><a href="{% url 'report_group' 2 %}">2- Deeb</a></li>
                        <li><a href="{% url 'report_group' 3 %}">3- Moutran</a></li>
                    </ul>
                </li>
	      	    <li><a href="{% url 'admin:index' %}">Admin</a></li>
	        </ul>
            <form class="navbar-form pull-right">
                <input id="publookahead" type="text" 
                    data-items="4" data-provide="typeahead" class="span2" autocomplete="off">
                <input id="hiddenid" type="hidden">
                <div class="btn-group">
                    <button class="btn" id="addreport">Add</button>
                    <a class="btn" href="#" data-toggle="modal" data-target="#myModal" id="showreport">Report</a>
                </div>
            </form>
	    </div>
	</div>
    
	{% endblock %}
    
        <div class="container-fluid">
        {% block content %}{% endblock %}
        </div>
        <!-- Modal -->
        <div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel">Publisher Card</h3>
            </div>
            <div class="modal-body">
                <p>One fine body…</p>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
            </div>
        </div>
    </body>
</html>
